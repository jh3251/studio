{
  "entities": {
    "AppUser": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AppUser",
      "type": "object",
      "description": "Represents a person within the app for tracking purposes, managed by the main authenticated user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the app user profile."
        },
        "userId": {
          "type": "string",
          "description": "The UID of the authenticated Firebase user who owns this record."
        },
        "name": {
          "type": "string",
          "description": "Display name of the person."
        }
      },
      "required": ["id", "userId", "name"]
    },
    "Expense": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Expense",
      "type": "object",
      "description": "Represents an expense recorded by the main authenticated user.",
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string", "description": "Owner's UID." },
        "userName": { "type": "string", "description": "Name of the person associated with the expense." },
        "categoryId": { "type": "string" },
        "date": { "type": "string", "format": "date-time" },
        "amount": { "type": "number" }
      },
      "required": ["id", "userId", "userName", "categoryId", "date", "amount"]
    },
    "Income": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Income",
      "type": "object",
      "description": "Represents an income recorded by the main authenticated user.",
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string", "description": "Owner's UID." },
        "userName": { "type": "string", "description": "Name of the person associated with the income." },
        "date": { "type": "string", "format": "date-time" },
        "amount": { "type": "number" }
      },
      "required": ["id", "userId", "userName", "date", "amount"]
    },
    "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents a category for expenses.",
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string", "description": "Owner's UID." },
        "name": { "type": "string" },
        "icon": { "type": "string" }
      },
      "required": ["id", "userId", "name", "icon"]
    }
  },
  "auth": {
    "providers": ["email"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/app_users/{appUserId}",
        "definition": {
          "entityName": "AppUser",
          "schema": { "$ref": "#/backend/entities/AppUser" },
          "description": "Stores user profiles managed by the main authenticated user."
        }
      },
      {
        "path": "/users/{userId}/categories/{categoryId}",
        "definition": {
          "entityName": "Category",
          "schema": { "$ref": "#/backend/entities/Category" },
          "description": "Stores expense categories created by the main authenticated user."
        }
      },
      {
        "path": "/users/{userId}/expenses/{expenseId}",
        "definition": {
          "entityName": "Expense",
          "schema": { "$ref": "#/backend/entities/Expense" },
          "description": "Stores expense records created by the main authenticated user."
        }
      },
      {
        "path": "/users/{userId}/incomes/{incomeId}",
        "definition": {
          "entityName": "Income",
          "schema": { "$ref": "#/backend/entities/Income" },
          "description": "Stores income records created by the main authenticated user."
        }
      }
    ],
    "reasoning": "The Firestore structure uses a top-level `users` collection where each document corresponds to a signed-in Firebase Auth user. All data for that user (their app users, categories, expenses, and incomes) is stored in subcollections under their user document. This structure ensures that all of a user's data is siloed, which makes writing security rules straightforward: a user can only access documents within their own `/users/{userId}` path."
  }
}
